<!DOCTYPE html>
<html>
<head>
    <title>Pippin Asset Management</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
<div class="container">
    <div class="sidebar">
        <h2>Pippin Assets</h2>
        <ul>
            <li><button onclick="showContent('user')">User</button></li>
            <li><button onclick="showContent('mac_laptop')">Mac Laptop</button></li>
            <li><button onclick="showContent('win_laptop')">Windows Laptop</button></li>
            <li><button onclick="showContent('desktop')">Desktop</button></li>
            <li><button onclick="showContent('mouse')">Mouse</button></li>
            <li><button onclick="showContent('keyboard')">Keyboard</button></li>
            <li><button onclick="showContent('usb_camera')">USB Camera</button></li>
            <li><button onclick="showContent('headset')">Headset</button></li>
            <li><button onclick="showContent('wifi_device')">WiFi Device</button></li>
            <li><button onclick="showContent('laptop_bag')">Laptop Bag</button></li>
            <li><button onclick="showContent('scrap_system')">Scrap System</button></li>
            <li><button onclick="showContent('software')">Software</button></li>
        </ul>
    </div>
    <div class="content" id="mainContent">
        <h3 style="text-align: center; color: rgb(121, 209, 244); font-size: 74px;">Welcome to Pippin Assets</h3>
        <p style="color: gray; font-size: 44px; text-align: center;">Your asset management hub</p>
    </div>
</div>

<script>
// Sidebar content switching
function showContent(type) {
    const content = document.getElementById('mainContent');
    let html = "";

    switch (type) {
        case 'user':
            html = `
                <div style="text-align:center; font-family: Arial, sans-serif;">
                    <h3 style="color: rgb(121, 209, 244); margin-bottom: 20px; font-size: 40px;">User Details</h3>
                    <div style="margin: 10px;">
                        <label for="empNo" style="font-size: 16px; margin-right: 10px;">Employee No</label>
                        <input id="empNo" type="text" placeholder="Enter Employee No" 
                               style="padding: 10px; font-size: 16px; width: 250px; border-radius: 8px; border: 1px solid #ccc;">
                    </div>
                    <button onclick="submitUser()" 
                            style="margin-top: 15px; padding: 10px 20px; font-size: 16px; background-color: rgba(232, 121, 244, 1); color: white; border: none; border-radius: 8px; cursor: pointer;">
                        Submit
                    </button>
                    <p id="resultMsg" style="margin-top: 20px; font-size: 18px; color: green;"></p>
                </div>
            `;
            break;
        default:
            html = `<h3 style="text-align:center;">${type.replace('_', ' ').toUpperCase()}</h3>`;
    }

    content.innerHTML = html;
}

// Employee lookup using JSONP
function submitUser() {
    const empNo = document.getElementById('empNo').value.trim();
    const resultMsg = document.getElementById('resultMsg');
    const gsheetApiUrl = "https://script.google.com/macros/s/AKfycbzhhAaCan9Q7vUl18szvCW4VHM38XR8m6mrDbsXI5O9iNrpZFvCkAvexq_27YO3RpqD/exec"; // Replace with your Apps Script Web App URL

    if (!empNo) {
        resultMsg.style.color = 'red';
        resultMsg.textContent = "❌ Please enter an Employee ID";
        return;
    }

    // Remove old JSONP script if exists
    const oldScript = document.getElementById('jsonpScript');
    if (oldScript) oldScript.remove();

    // Create new script for JSONP
    const script = document.createElement('script');
    script.id = 'jsonpScript';
    script.src = `${gsheetApiUrl}?empNo=${encodeURIComponent(empNo)}&callback=handleResponse`;
    document.body.appendChild(script);

    // Callback function
    window.handleResponse = function(data) {
        if (!data) {
            resultMsg.style.color = 'red';
            resultMsg.textContent = "❌ No response from server.";
            return;
        }

        if (data.error) {
            resultMsg.style.color = 'red';
            resultMsg.textContent = `❌ ${data.error}`;
            return;
        }

        if (data.exists) {
            resultMsg.style.color = 'green';
            let detailsHtml = `<p>✅ Details available for Employee ID: ${empNo}</p><ul>`;
            for (const [key, value] of Object.entries(data.details)) {
                detailsHtml += `<li><strong>${key}:</strong> ${value}</li>`;
            }
            detailsHtml += `</ul>`;
            resultMsg.innerHTML = detailsHtml;
        } else {
            resultMsg.style.color = 'red';
            resultMsg.textContent = "❌ No details found for this Employee ID.";
        }
    };
}
</script>
</body>
</html>
